# Project Prompt Instructions

## 基本規範
- 所有 `prompt.md` 需直接在文件內完整貼上所引用的 `_core` 與 `_stylepacks` 模板內容，不得以連結、代碼或簡寫方式引用。
- 專案目錄內僅輸出 `prompt.md` 主檔；禁止生成 `meta.md` 或其他引用摘要檔案。
- 若需要新增重複使用的內容，請先確認是否已有對應模板，再決定是否撰寫新段落，並同樣完整內嵌於 `prompt.md`。
- 影片長度若未特別註明，預設為 **15 秒**，請在 Master Prompt 與分鏡區塊明確標記時間軸（建議 **12 幕 × 1.2s**）。
- 分鏡需維持 **Act → Beat → Angle** 的層級結構，並補齊運鏡、光影、聲音與轉場細節以利動畫工具解析。
- 專案請以「`<專案名稱>/<YYYY-MM-DD>_ep<集數>-<slug>`」的層級分類，建立 `prompt.md` 時務必放置於對應日期與集數資料夾內。
- 每份 `prompt.md` 正文至少 **450 行**，需確保所有模板內容與分鏡細節完整展開，不得因精簡而低於行數下限。
- **所有專案日期一律以 UTC+8（台灣時間）當下日期為準**：建立新專案時，需依當下 UTC+8 的日期決定檔名中的日期標記。
  - 例如：在 2025-11-14 10:23（UTC+8）為「異界編譯」系列撰寫第三集、slug 為 `curve-bolt-second-strike_v01` 的專案，其路徑應為：
    `異界編譯/2025-11-14_ep3-curve-bolt-second-strike_v01/prompt.md`

### 精細度與展開原則
- 每段敘述以「**具體名詞 + 量化形容詞 + 物理行為 + 感官線索**」為句型基礎，避免單句內出現未定義的代稱或僅靠「高質感、漂亮」等空泛詞。
- 對於環境、角色、道具、光源、聲音、運鏡等關鍵元素，務必在首次出現時標註 2–3 個可測量或可觀察的指標（尺寸/重量/溫度/速度/頻率/亮度/色碼/粒度），之後再延伸描述變化。
- 每個 Act 至少加入 1 段 **micro-actions**（< 1.2s 的細部動作鏈），逐幀說明姿態、支撐點、反作用力與反饋，確保動畫工具可解析。
- 如使用修辭或隱喻，需立即在括號內補充可操作的視覺或聲音對應，不得讓執行者自行揣測。
- 當描述需要「同時發生」的事件，請以時間戳記或項目符號標示「T0、T0+0.3s、T0+0.6s」等節點，並點明鏡頭參數在每個節點的調整。

## 物理寫實與高級質感要求
- 任何 Act/Beat/Angle 的描述都必須標註對應的真實物理特徵（重力、慣性、摩擦、流體/布料/粒子反應），並指明鏡頭內的光學行為（折射、次表面散射、鏡面/粗糙反射）。
- 材質必寫 PBR 參數與微表面細節（粗糙度、金屬度、法線/置換、指紋與磨痕等使用痕跡），並交代光源色溫、能量分佈、環境遮蔽或體積霧對畫面的影響。
- 每幕需敘明高級質感的來源：如電影級光比、膚質分層（base color/SSS/specular）、高解析紋理、景深/畸變校正與顆粒控制，避免僅以「高品質」空泛描述。
- 以上物理與質感細節必須完整收錄在 `prompt.md` 的 Master Prompt 及各分鏡段落，不得省略或以「同前鏡」代稱。

### 深度質感層次寫法
- 針對材質，強制提供三層細節：**基底（Base Color/Albedo） → 次表面與微結構（SSS、微刮痕、指紋、油膜） → 表層干涉（鏡面/粗糙反射、菲涅耳、光暈/眩光控制）**，並說明各層對光線與陰影的影響。
- 若場景含有流體、霧、火花或粒子效果，需交代介質密度、散射與吸收係數、粒徑分佈、模擬求解方式（如 VDB/Flip/粒子數量上限）與運算預期成本。
- 對於角色膚質與布料，必須描述貼圖解析度、縫線/纖維走向、磨損區域與碰撞行為；若有風、雨、煙或灰塵干擾，列出力場方向、強度與持續時間。
- 碰撞或接觸場景需指出接觸面的摩擦係數、彈性係數與阻尼，並寫明衝擊後的能量分配或二次運動（衣物揚起、飄帶延遲、飄散方向）。

## 風格擴充流程
- 遇到全新製片風格需求時，於對應 `prompt.md` 的 `_stylepacks` 區塊新增一段 **新風格樣板**，以「`Style: <風格名稱>`」標題開頭，後接明確的視覺、敘事、攝影與聲音特徵描述。
- 新風格樣板須標註適用情境與不可混用的限制，並附上 1～2 個代表性元素，方便後續檢索與一致化運用。
- 若新風格可能重複使用，可於內部知識庫另行保存同名樣板全文，但在專案倉庫內仍僅保留 `prompt.md`，以維持檔案規範。

## 行為與介面強化
- 產出前必須要求且檢查輸入欄位：`project_name`、`series_name/arc`、`episode_index`、`slug`、`target_platform`、`duration_sec`（預設 15）、`style_primary`、`style_secondary`、`worldstate_ref`、`goal`。
- 輸出僅能是一份完整的 `prompt.md`，且必備 `_core`、`_stylepacks`、Master Prompt、Act/Beat/Angle 分鏡、Platform Layer 與 Self-Check 區塊。
- 若劇情、世界觀或角色資訊有不確定處，禁止自行補完，必須在 `### Assumptions` 中列出假設並標註理由，供人類審核。
- 每份 `prompt.md` 結尾強制加入「## AGENT Self-Check」，逐項回答：結構（Master/Act/Beat/Angle/timecode）、Physics & PBR（各幕重力/慣性與材質/光學）、Stylepacks 使用與衝突、Continuity（引用的上一集狀態機與 Persistent Elements）。
- 每次提交前，Self-Check 必須主動揭露不足或不確定的項目，不得空白。

### 進階欄位提示
- Master Prompt 必須列出：場景與角色的 **worldstate snapshot**、跨集或跨鏡的 **constraint list**（不可改變的姿態/道具位置/角色情緒曲線）、以及 **execution note**（建議採用的求解或合成方法，如 camera projection、volume pass、denoise 限制）。
- `_core` 與 `_stylepacks` 段落新增「**Do/Don't**」小節，清晰列出可用與禁用的鏡頭語言、調色手法、構圖忌諱，並在分鏡內實際引用（例如「遵循 Do: 對比度 1.8 gamma curve」）。
- `Platform Layer` 需補充「切片輸出策略」：短版/長版各需標註可直接截取的時間段與對應字幕行，避免重寫。
- `## Negative Instructions` 增列「自動檢核清單」，逐條確認是否出現禁用商標、侵權角色、政治宗教符號、血腥/成人尺度、錯誤語言環境或不合規字幕。

## 品質自檢清單（須全數達到 10/10）
1. **結構完整度**：Master Prompt 與分鏡層級是否齊全、時間軸是否明確。
2. **敘事一致性**：Act、Beat 與 Angle 描述是否連貫且符合風格樣板。
3. **視聽細節**：攝影、光影、聲音、轉場等是否具體、可操作。
4. **風格準確性**：引用或新增之 `_stylepacks` 是否貼合需求且無衝突。
5. **格式精準度**：段落、縮排、標點與命名是否符合專案規範。
6. **物理質感到位**：各幕是否寫明重力/慣性、布料或流體反應、光學行為與 PBR 材質參數，高級質感來源是否完整植入 Master Prompt 與分鏡。
7. **量化標記度**：各 Act/Beat/Angle 是否具備量化指標、時間節點與同步事件標註，是否避免模糊詞彙或未定義代稱。
8. **可交付性**：平台/字幕/切片輸出策略是否明確可直接執行，Self-Check 是否具體揭露風險與待補資訊。

每個項目須自評 10/10 後方可提交，並於提交前再次確認無遺漏檔案或未依規定建立資料夾階層。

## Prompt 結構擴充
- 必備 `## Technical Specs`：統一列出 Aspect Ratio（9:16 直式）、FPS、180 度快門運動模糊、鏡頭組（24/35/50/75mm 用途註記）、景深與焦外、顆粒控制、色彩流程（log → filmic LUT → final contrast）、社群壓縮下的細節保留策略。
- 新增 `## Platform Layer`：hook line（0–1s）、first-shot visual hook、字幕/Caption 建議（短版/長版）、縮圖構圖、Hashtag 建議、CTA 需求；同一支影片需提供 Hook A（故事向）與 Hook B（迷因/衝擊向）。
- `_stylepacks` 內每個 Style 必須標註 Applicable for、Do NOT mix with、Default ON/OFF、Visual/Audio traits，避免風格衝突並清楚開關。
- 每個 Angle 強制含 5 欄位：Camera、Lighting、Materials & Physics（含重力/慣性與 PBR）、Emotion & Performance、Audio & Transition。禁止以「同前」代稱。
- 必備 `## Negative Instructions`：列出禁用內容（真實商標/名人/宗教政治符號等）、避免的畫面風格（過曝、廉價濾鏡、過度晃動/魚眼）、畫面尺度限制（PG-13 等）。
- 在 `_core` 加入品牌層：品牌角色共同特徵、場景色調與光感、文案語氣（中日英混用節奏），作為全系列 Brand Bible。

## SORA 編譯與交付流程
- 產出 `prompt.md` 後，必須再執行一次「SORA PROMPT COMPILER」，將完整稿壓縮成短版 `sora.md`（實際為 JSON），以便直接餵入 SORA。
- `sora.md` JSON 必備欄位：
  - `meta`：project_name、series_name、episode_index、slug、duration_sec（預設 15）、shots_count（預設 12）、aspect_ratio、fps。
  - `style`：`primary`、`secondary` 兩句英文概述，從 `_stylepacks` 精選 1–2 個風格摘要，不可直接複製全文。
  - `global_prompt`：3–4 句英文，描述場景位置/時間、主角外觀、整體情緒與運鏡/光感。
  - `negative_prompt`：一句英文逗號分隔的禁用項（logo、文字、品牌、政治宗教符號、血腥尺度、低品質濾鏡等）。
  - `shots`：依 Act/Beat/Angle 映射為 12 幕（約 1.2s/shot），每個 `id` 為 `S01…S12`，包含 `time.start/end`、`prompt`（3–5 句英文整合景框/光線/材質/情緒/聲音）、可選 `camera`/`motion`/`audio` 短句。
- 轉譯規則：
  - 僅保留渲染所需資訊：專案與風格基本資料、Master Prompt 的 worldstate、Act/Beat/Angle 的鏡頭內容、Negative Instructions 的核心禁用項。
  - 禁止將 `_core`/`_stylepacks` 全文、PBR 或模擬參數表、Platform Layer、Self-Check、Changelog、Next Episode 等人類審核文字帶入 `sora.md`。
  - 時間切分以 `duration_sec ÷ shots_count` 平均換算；若時長或幕數不同，需同步調整 `time.start/end`。
  - 所有輸出必須為 100% 英文且為有效 JSON，無額外說明文字或程式碼區塊包裝。
- 建議 Compiler 指令（可直接丟給 GPT/Claude）：
  - 宣告「You are a SORA PROMPT COMPILER」並提供上述 JSON schema。
  - 指示只抽取必要資訊並套用 3–5 句精煉英文描述，整合相機/光影/材質/情緒/聲音。
  - 要求輸出僅為最終 JSON，禁止附註解或附加說明。

## 連續劇集製作指引

### 定義連載骨架與狀態機
- 先於專案根目錄建立「系列主控稿」，以表格列出季別、集數、主要敘事弧線與每集 cliffhanger，並標註必備角色與道具狀態。
- 建立狀態機圖示：列出 Act → Beat → Angle 的狀態流轉與條件（如角色心境改變、場景轉換、時間跳躍），確保每集延續上一集的終止狀態。
- 每次新增劇集前，以上一集的終止節點為初始狀態，更新必須銜接的事件與限制，避免平行版本或情節矛盾。

### 維護共享世界與角色模板
- 在 `_core` 段落中維護世界觀設定與角色檔案，統一角色口頭禪、動作習慣、服裝色票與關鍵道具描述。
- 若角色或場景有變動（例如造型、武器、場景破壞），需在模板中標註有效集數與變動原因，並更新後續集數的預設狀態。
- 每次撰寫新集劇本時，直接複製最新模板，避免漏掉關鍵屬性或沿用過時資訊。

### 新動作前先複述前一鏡面狀態
- 在每個 Beat 開頭以 1～2 句重述上一鏡面（或上一集最後鏡面）的角色位置、情緒與環境條件，並標註與狀態機相符的節點 ID。
- 僅在確認重述完成後，才撰寫新的動作或對話指令；若須引入新元素，必須說明其與既有狀態的關聯。
- 對於多線敘事，分別記錄每條線的前一鏡面摘要，確保平行剪輯依然維持時間與邏輯一致。

### 攝影延續與轉場規劃
- 於 Master Prompt 中新增「Camera Continuity」子段落，明確記錄前一集結束時的鏡頭參數（焦距、機位、運鏡方向、光比）與延續需求。
- 對每個 Act 預先列出預計轉場（硬切、推拉、疊化、匹配剪接）與過渡鏡頭，確保跨集銜接時不產生突兀變化。
- 若須更換攝影語言，必須撰寫「轉換前置條件」，如劇情節點或視覺暗示，方便動畫師掌握節奏。

### 持續性要素清單
- 建立「Persistent Elements」表格，列出需跨集保留的 props、UI、字幕樣式、音樂動機與場景損毀狀態，並標註是否已使用、預計解除集數。
- 為每項要素附上視覺或聲音參考（色碼、音階、紋理描述），確保不同集數的 prompt 作者都能複製相同質感。
- 在每集交付前交叉檢查清單，若有新要素加入或舊要素退場，必須更新表格並在提交記錄中註明調整理由。

### Platform 與敘事迭代
- 每集結尾補充「Next Episode / Spin-off Ideas」：至少兩個主線延伸方向與一個番外/日常短片點子，方便回饋到下一集製作。
- 在 `prompt.md` 中新增「## Changelog vs Previous Episode」：記錄角色外觀變化、場景損毀狀態、登場/退場的道具或 UI、停用的招式與要素。
